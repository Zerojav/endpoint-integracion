<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Confirmación de Pago</title>
</head>
<body>
  <h1>⏳ Verificando pago...</h1>
  <div id="resultado"></div>

  <script>
    const params = new URLSearchParams(window.location.search);
    const id = params.get("id");
    const clientTransactionId = params.get("clientTransactionId");

    fetch("https://sandbox.payphone.com/api/button/Confirm", {
      method: "POST",
      headers: {
        "Authorization": "wrPUSQfjR-GCEFuaIWVGK4wvBycFljhVQTyO8q1i56c7GnoBXh6tosgP5cQxR0Xx5VA4pbb-xb12qVFnkTcR54MR3zx-u16Qf7WKf64We9j-SNXcsCGLICgwiI2bhfurKCtLL2p-XiL8Tx1lxXNou5Tool60cznwFLN57zFBTLgEz5a3nm7wvtakueGM1zqg9Ygs5HuJlmUIY51tfpVgf_gxmAyQvhwi4qfQ8o2XZkmGhlN8bdfM_rpVmjk006JdiehQphBPScuzRHZQYrrnBxfUbZyoaUFrZkicIhtryaDdntIEFuYc8rjHK0vbmZGh7ExJCyBW5EGQiv5QkDCTmhQVXis", // reemplaza este valor
        "Content-Type": "application/json"
      },
      body: JSON.stringify({
        id: parseInt(id),
        clientTransactionId: clientTransactionId
      })
    })
    .then(res => res.json())
    .then(data => {
      const div = document.getElementById("resultado");
      if (data.status === "APPROVED") {
        div.innerHTML = "<h2 style='color:green;'>✅ Pago aprobado</h2>";
      } else {
        div.innerHTML = "<h2 style='color:red;'>❌ Pago rechazado</h2>";
      }
    })
    .catch(err => {
      document.getElementById("resultado").innerHTML = "⚠️ Error al verificar pago.";
      console.error(err);
    });
  </script>
</body>
</html>
